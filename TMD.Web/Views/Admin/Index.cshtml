@model TMD.Web.ViewModels.Prisoner.PrisonerViewModel

@{
    ViewBag.Title = "Home";
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
}


<!-- Main bar -->
<div class="mainbar">

    <!-- Page heading -->
    <div class="page-head">
        <h2>Dashboard <small>Prisoner</small></h2>

        <div class="clearfix"></div>


        <div class="clearfix"></div>

    </div>
    <!-- Page heading ends -->
    <!-- Matter -->

    <div class="matter">
        <div class="container">

            <div class="row">
                <div class="col-lg-4 col-md-3 col-sm-6 col-xs-12">
                    <div class="dashboard-stat red-intense">
                        <div class="visual">
                            <i class="fa fa-warning"></i>
                        </div>
                        <div class="details">
                            <div class="number" style="padding-top:5px;">
                                @Model.DetainedToday
                                <span class="desc">
                                    Detained
                                </span>
                            </div>
                            <div class="number" style="padding-top:5px;">
                                @Model.ReleasedToday
                                <span class="desc">
                                    Released
                                </span>
                            </div>
                        </div>
                        <a class="more" href="#">
                            Today <i class="m-icon-swapright m-icon-white"></i>
                        </a>
                    </div>
                </div>

                <div class="col-lg-4 col-md-3 col-sm-6 col-xs-12">
                    <div class="dashboard-stat purple-plum">
                        <div class="visual">
                            <i class="fa fa-bar-chart-o"></i>
                        </div>
                        <div class="details">
                            <div class="number" style="padding-top:5px;">
                                @Model.DetainedWeek
                                <span class="desc">
                                    Detained
                                </span>
                            </div>
                            <div class="number" style="padding-top:5px;">
                                @Model.ReleasedWeek
                                <span class="desc">
                                    Released
                                </span>
                            </div>
                        </div>

                        <a class="more" href="#">
                            Last 7 Days <i class="m-icon-swapright m-icon-white"></i>
                        </a>
                    </div>
                </div>
                <div class="col-lg-4 col-md-3 col-sm-6 col-xs-12">
                    <div class="dashboard-stat green-haze">
                        <div class="visual">
                            <i class="fa fa-ticket"></i>
                        </div>
                        <div class="details">
                            <div class="number" style="padding-top:5px;">
                                @Model.DetainedMonth
                                <span class="desc">
                                    Detained
                                </span>
                            </div>
                            <div class="number" style="padding-top:5px;">
                                @Model.ReleasedMonth
                                <span class="desc">
                                    Released
                                </span>
                            </div>
                        </div>
                        <a class="more" href="#">
                            Last 30 Days <i class="m-icon-swapright m-icon-white"></i>
                        </a>
                    </div>
                </div>

                <!-- END DASHBOARD STATS -->
            </div>

            <!-- Dashboard Graph starts -->

            <div class="row">


                <div class="col-md-12 portlets">

                    <div class="widget">

                        <div class="widget removeWidgetTDMargin">
                            <!-- Widget title -->
                            <div class="widget-head widgetHeadRed">
                                <div class="pull-left">Prisoners to be Released in Next 30 Days</div>
                                <div class="widget-icons pull-right">
                                    <a href="#" class="wminimize"><i class="fa fa-chevron-up"></i></a>
                                    @*<a href="#" class="wclose"><i class="fa fa-times"></i></a>*@
                                </div>
                                <div class="clearfix"></div>
                            </div>
                            <div class="widget-content referrer">
                                <!-- Widget content -->

                                <table class="table table-striped table-bordered table-hover responsive" id="">
                                    <thead>
                                        <tr>
                                            <th>Passport #</th>
                                            <th>Iqama #</th>
                                            <th>Name</th>
                                            <th>Release Date</th>
                                            <th>Case Type</th>
                                            <th>City</th>
                                        </tr>
                                    </thead>

                                    <tbody>
                                        @foreach (var item in Model.PrisonerList)
                                        {
                                        <tr>
                                            <td>@item.PrisonerPassport</td>
                                            <td>@item.Iqama</td>
                                            <td>@item.Name</td>
                                            <td class="bold">@item.ReleaseDate</td>
                                            <td>@item.CaseType</td>
                                            <td>@item.Address</td>
                                        </tr>
                                        }

                                    </tbody>

                                </table>
                            </div>
                        </div>

                    </div>

                </div>

            </div>
            <div class="row">
                <div class="col-md-12 portlets">
                    <div class="pull-right col-lg-12">
                        <div id="reportrange" class="pull-right">
                            <i class="fa fa-calendar"></i>
                            <span></span> <b class="caret"></b>
                        </div>
                    </div>

                    <ul class="nav nav-tabs">
                        <li class="active"><a href="#tabs-1" data-toggle="tab">Recent Prisoners Detained</a></li>
                        <li><a href="#tabs-2" data-toggle="tab">Recent Prisoners Released</a></li>
                        <li><a href="#tabs-3" data-toggle="tab">Number Of Prisoners By jails</a></li>
                        <li><a href="#tabs-4" data-toggle="tab">Number Of Prisoners By Case Types</a></li>
                        <li><a href="#tabs-5" data-toggle="tab">Number Of Prisoners By Case Status</a></li>
                    </ul>
                    <div class="tab-content">
                        <div id="tabs-1" class="tab-pane active">
                            <div class="widget col-md-12 removeWidgetLRPadding">
                                <!-- Widget title -->
                                <div class="widget-head widgetHeadBlue">
                                    <div class="pull-left">Recent Prisoners Detained</div>
                                    <div class="widget-icons pull-right">
                                        <a href="#" class="wminimize"><i class="fa fa-chevron-up"></i></a>

                                    </div>
                                    <div class="clearfix"></div>
                                </div>
                                <div class="widget-content referrer">
                                    <!-- Widget content -->

                                    <table class="table table-striped table-bordered table-hover responsive" id="Detained">
                                        <thead>
                                            <tr>
                                                <th>Passport #</th>
                                                <th>Iqama #</th>
                                                <th>Name</th>
                                                <th>Detention Date</th>
                                                <th>Case Type</th>
                                                <th>City</th>
                                            </tr>
                                        </thead>

                                        <tbody id="ReleasedBody">
                                            @foreach (var item in Model.PrisonerDetainedList)
                                            {
                                            <tr>
                                                <td>@item.PrisonerPassport</td>
                                                <td>@item.Iqama</td>
                                                <td>@item.Name</td>
                                                <td class="bold">@item.DetentionDate</td>
                                                <td>@item.CaseType</td>
                                                <td>@item.Address</td>
                                            </tr>
                                            }

                                        </tbody>

                                    </table>

                                </div>
                            </div>
                        </div>

                        <div id="tabs-2" class="tab-pane">
                            <div class="widget col-md-12 removeWidgetLRPadding">
                                <!-- Widget title -->
                                <div class="widget-head widgetHeadGreen">
                                    <div class="pull-left">Recent Prisoners Released</div>
                                    <div class="widget-icons pull-right">
                                        <a href="#" class="wminimize"><i class="fa fa-chevron-up"></i></a>
                                    </div>
                                    <div class="clearfix"></div>
                                </div>
                                <div class="widget-content referrer">
                                    <!-- Widget content -->
                                    <table class="table table-striped table-bordered table-hover responsive" id="Released">
                                        <thead>
                                            <tr>
                                                <th>Passport #</th>
                                                <th>Iqama #</th>
                                                <th>Name</th>
                                                <th>Release Date</th>
                                                <th>Case Type</th>
                                                <th>City</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (var item in Model.PrisonerReleasedList)
                                            {
                                            <tr>
                                                <td>@item.PrisonerPassport</td>
                                                <td>@item.Iqama</td>
                                                <td>@item.Name</td>
                                                <td class="bold">@item.ReleaseDate</td>
                                                <td>@item.CaseType</td>
                                                <td>@item.Address</td>
                                            </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                        <div id="tabs-3" class="tab-pane">
                            <div class="widget col-md-12 removeWidgetLRPadding">
                                <!-- Widget title -->
                                <div class="widget-head widgetHeadGreen">
                                    <div class="pull-left">Recent Prisoners Released</div>
                                    <div class="widget-icons pull-right">
                                        <a href="#" class="wminimize"><i class="fa fa-chevron-up"></i></a>
                                    </div>
                                    <div class="clearfix"></div>
                                </div>
                                <div class="widget-content referrer">
                                    <!-- Widget content -->
                                    <table class="table table-striped table-bordered table-hover responsive" id="Released">
                                        <thead>
                                            <tr>
                                                <th>Passport #</th>
                                                <th>Iqama #</th>
                                                <th>Name</th>
                                                <th>Release Date</th>
                                                <th>Case Type</th>
                                                <th>City</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (var item in Model.PrisonerReleasedList)
                                            {
                                                <tr>
                                                    <td>@item.PrisonerPassport</td>
                                                    <td>@item.Iqama</td>
                                                    <td>@item.Name</td>
                                                    <td class="bold">@item.ReleaseDate</td>
                                                    <td>@item.CaseType</td>
                                                    <td>@item.Address</td>
                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div id="tabs-4" class="tab-pane">
                            <div class="widget col-md-12 removeWidgetLRPadding">
                                <!-- Widget title -->
                                <div class="widget-head widgetHeadGreen">
                                    <div class="pull-left">Recent Prisoners Released</div>
                                    <div class="widget-icons pull-right">
                                        <a href="#" class="wminimize"><i class="fa fa-chevron-up"></i></a>
                                    </div>
                                    <div class="clearfix"></div>
                                </div>
                                <div class="widget-content referrer">
                                    <!-- Widget content -->
                                    <table class="table table-striped table-bordered table-hover responsive" id="Released">
                                        <thead>
                                            <tr>
                                                <th>Passport #</th>
                                                <th>Iqama #</th>
                                                <th>Name</th>
                                                <th>Release Date</th>
                                                <th>Case Type</th>
                                                <th>City</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (var item in Model.PrisonerReleasedList)
                                            {
                                                <tr>
                                                    <td>@item.PrisonerPassport</td>
                                                    <td>@item.Iqama</td>
                                                    <td>@item.Name</td>
                                                    <td class="bold">@item.ReleaseDate</td>
                                                    <td>@item.CaseType</td>
                                                    <td>@item.Address</td>
                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        <div id="tabs-5" class="tab-pane">
                            <div class="widget col-md-12 removeWidgetLRPadding">
                                <!-- Widget title -->
                                <div class="widget-head widgetHeadGreen">
                                    <div class="pull-left">Recent Prisoners Released</div>
                                    <div class="widget-icons pull-right">
                                        <a href="#" class="wminimize"><i class="fa fa-chevron-up"></i></a>
                                    </div>
                                    <div class="clearfix"></div>
                                </div>
                                <div class="widget-content referrer">
                                    <!-- Widget content -->
                                    <table class="table table-striped table-bordered table-hover responsive" id="Released">
                                        <thead>
                                            <tr>
                                                <th>Passport #</th>
                                                <th>Iqama #</th>
                                                <th>Name</th>
                                                <th>Release Date</th>
                                                <th>Case Type</th>
                                                <th>City</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            @foreach (var item in Model.PrisonerReleasedList)
                                            {
                                                <tr>
                                                    <td>@item.PrisonerPassport</td>
                                                    <td>@item.Iqama</td>
                                                    <td>@item.Name</td>
                                                    <td class="bold">@item.ReleaseDate</td>
                                                    <td>@item.CaseType</td>
                                                    <td>@item.Address</td>
                                                </tr>
                                            }
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Matter ends -->

</div>

<!-- Mainbar ends -->
<script type="text/javascript">
    var toBeReleasedTable;
    var releasedTable;
    var detainedTable;
    $(document).ready(function () {
        toBeReleasedTable = $('#toBeReleased').dataTable({
            "sPaginationType": "full_numbers",
            "iDisplayLength": 10,
            "bFilter": true,
            "bLengthChange": false,
            "aoColumnDefs": [
                { 'bSortable': false, 'aTargets': [0] },
                {
                    "targets": [0],
                    "visible": false,
                    "searchable": false
                }
            ]
        });

        detainedTable = $('#Detained').dataTable({
            "sPaginationType": "full_numbers",
            "iDisplayLength": 10,
            "bFilter": true,
            "bLengthChange": false
        });

        releasedTable = $('#Released').dataTable({
            "sPaginationType": "full_numbers",
            "iDisplayLength": 10,
            "bFilter": true,
            "bLengthChange": false
        });
    });//end document.ready()
    function successFunc(data, status) {
        //start Recent Detained table
        detainedTable.fnClearTable();
        $.each(data.responseJSON.PrisonerDetainedList, function (index, item) {
            detainedTable.fnAddData([item.PrisonerPassport, item.Iqama, item.Name, item.DetentionDate, item.CaseType, item.Address], false);
        });
        detainedTable._fnReDraw();
        //end Recent Detained table
        //start Recent Released table
        releasedTable.fnClearTable();
        $.each(data.responseJSON.PrisonerReleasedList, function (index, item) {
            releasedTable.fnAddData([item.PrisonerPassport, item.Iqama, item.Name, item.ReleaseDate, item.CaseType, item.Address], false);
        });
        releasedTable._fnReDraw();
        //end Recent Released table
        toastr.success("Successfully loaded the data.");
    }

    function filterPrisoners(start, end) {
        var serviceUrl = $("#siteURL").val() + '/Admin/Index';
        $.ajax({
            type: "POST",
            url: serviceUrl,
            data: { StartDate: start, EndDate: end },
            dataType: "json",
            complete: function (data) {
                if (data.status === 200) {
                    successFunc(data);
                }
                else {
                    errorFunc(data);
                }
            }
        });
    }//end filterPrisoners

    function errorFunc(error) {
        toastr.error("There is some problem. Try again.");
    }

</script>

<style type="text/css">
    .dataTables_filter {
        display: none !important;
    }

    .table thead tr th {
        font-size: 12px !important;
        vertical-align: text-top;
    }

    .table tbody tr td {
        font-size: 12px !important;
    }
</style>
